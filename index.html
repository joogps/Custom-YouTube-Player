<!DOCTYPE html>
<html>
<head>
	<title>Approximating Pi - Livestream</title>
	<link rel="icon" type="image/png" href="favicon.png">

	<style>
		body {
			margin: 0;
			background: lightgrey;
		}

		table {
			position: absolute;
			width: 100%;
			height: 100%;

			border-spacing: 15px;
		}

		td {
			vertical-align: top;
			padding: 0px;
		}

		iframe {
			width: 100%;
			height: 100%;
		}

		.input {
			width: calc(100% - 19px);
			height: 20px;
			padding-left: 15px;
		}

		.input:focus {
			outline: black solid 1px;
		}

		.song {
			height: calc(100% - 26px);
		}
	</style>
</head>
<body>
	<table>
		<tr>
			<td>
				<iframe class="video" src="https://www.youtube.com/embed/PIeKyP97EUc?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"></iframe> 
			</td>
			<td rowspan="2">
				<iframe class="chat" src="https://www.youtube.com/live_chat?v=PIeKyP97EUc&embed_domain=joogps.github.io"></iframe>
			</td>
		</tr>
		<tr>
			<td>
				<input class="input" placeholder="Playlist or video URL goes here"></input>
				<iframe class="song" src="https://www.youtube.com/embed/M5d7vygUPoQ?autoplay=1" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"></iframe>
			</td>
		</tr>
	</table>
</body>

<script>
	document.getElementsByClassName("input")[0].addEventListener("keyup", function(e) {
		let url = this.value;
		let playback = document.getElementsByClassName("playback")[0];
		if (e.keyCode == 13) {
			if(youtube_video(url) && youtube_playlist(url)) {
				playback.src = "https://www.youtube.com/embed?v="+youtube_video(url)+"&list="+youtube_playlist(url)+"?autoplay=1";
			}
			else if(youtube_video(url)) {
				playback.src = "https://www.youtube.com/embed/"+youtube_video(url)+"?autoplay=1";
			}
			else if(youtube_playlist(url)) {
				playback.src = "https://www.youtube.com/embed?list="+youtube_playlist(url)+"?autoplay=1";
			}
		}
	}
	)

	function youtube_video(url){
		var regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/;
		var match = url.match(regExp);
		return (match&&match[7].length==11)? match[7] : false;
	}

	function youtube_playlist(url){
		var regExp = /^.*((youtu.be\/)|list=([^#\&\?]+))/;
		var match = url.match(regExp);
		return (match&&match[3].length==34)? match[3] : false;
	}
</script>
</html>